
#!/usr/bin/env bash
# (ensure we pull bash from path not /usr/bin)
set -e

if git status --porcelain | grep -q '^[ M]'
then
   echo "There are locally modified files. Stash or discard them before pushing."
   exit 1
else
   echo "No locally modified files. Formatting."
   yarn tidy
   if git status --porcelain | grep -q '^[ M]'
   then
      echo "Formatting changes found. Committing."
      git layout # requires script/dev-setup.sh to have been run
   fi
fi
